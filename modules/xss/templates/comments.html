<!-- templates/comments.html -->
{% extends "base.html" %}
{% block content %}
<h2>Stored XSS â€” Comments</h2>
<form method="post" action="{{ url_for('comments') }}">
  <label>Your name: <input name="name"></label><br><br>
  <label>Comment:<br>
    <textarea name="comment" rows="4" cols="50"></textarea>
  </label><br>
  <button>Post comment</button>
</form>

<hr>
<h3>Recent comments</h3>
<ul>
  {# Intentional vulnerability: comment rendered with |safe so stored script will run in viewers' browsers #}
  {% for c in comments %}
    <li><strong>{{ c['name']|e }}</strong>: <span>{{ c['comment']|safe }}</span></li>
  {% else %}
    <li>No comments yet.</li>
  {% endfor %}
</ul>

<p>Post a comment containing a script like <code>&lt;script&gt;alert('stored')&lt;/script&gt;</code> and then reload to see it execute.</p>
{% endblock %}
